{"ast":null,"code":"import User from './user';\nimport { users, problems } from \"../globals\";\nimport Problem from \"../problem/Problem\";\nimport API from '../Api/index';\n\nfunction resolve(x) {\n  return new Promise(func => {\n    setTimeout(() => {\n      func(x);\n    }, 1);\n  });\n}\n\nfunction reject(error) {\n  return new Promise((resolve, func) => {\n    setTimeout(() => {\n      func(error);\n    }, 1);\n  });\n}\n\nconst userService = {\n  async login(login, password) {\n    let response = await API.get('/login', {\n      params: {\n        'username': login,\n        'password': password\n      }\n    });\n    console.log(response.data);\n\n    if (response.data === 1) {\n      return reject('Нет таких зарегистрированных пользователей');\n    } else {\n      if (response.data === 2) {\n        return reject('Неверный пароль');\n      } else {\n        return resolve({\n          user: new User(login, password, true)\n        });\n      }\n    }\n  },\n\n  async logout(login) {\n    return resolve({\n      user: null\n    });\n  },\n\n  async register(login, password) {\n    console.log(login);\n    console.log(password);\n    const response = await API.post('/signup', {\n      'username': login,\n      'password': password\n    });\n    console.log(response);\n\n    if (response.data === false) {\n      return reject('Такой пользователь уже существует');\n    } else {\n      return resolve({\n        user: new User(login, password, true)\n      });\n    }\n  },\n\n  async editProblem(problem, user) {\n    const username = user.login;\n    const password = user.password;\n    const token = Buffer.from(`${username}:${password}`, 'utf8').toString('base64');\n    const data = {\n      'title': problem.name,\n      'statement': problem.task,\n      'solution': problem.solution,\n      'author': problem.author,\n      'username': user.login,\n      'id': problem.id\n    };\n    await API.post('/problem', data, {\n      headers: {\n        'Authorization': `Basic ${token}`\n      }\n    });\n    return resolve({\n      problem: problems.get(problem.id)\n    });\n  },\n\n  async addProblem(problem, user) {\n    const username = user.login;\n    const password = user.password;\n    const token = Buffer.from(`${username}:${password}`, 'utf8').toString('base64');\n    const data = {\n      'title': problem.name,\n      'statement': problem.task,\n      'solution': problem.solution,\n      'author': problem.author,\n      'username': user.login\n    };\n    await API.post('/problem', data, {\n      headers: {\n        'Authorization': `Basic ${token}`\n      }\n    });\n    return resolve({\n      problem: problems.get(problem.id)\n    });\n  },\n\n  async init() {\n    let problems_list_back = await API.get('/problem/all');\n    console.log('I am here');\n    console.log(problems_list_back.data);\n    let problems_list = new Map();\n    problems_list_back.data.forEach(function (problem) {\n      problems_list.set(problem.id, new Problem(problem.title, problem.statement, problem.solution, problem.author, problem.username, problem.id));\n    });\n    return resolve(problems_list);\n  }\n\n};\nexport default userService;","map":{"version":3,"sources":["/home/daniil/WebstormProjects/untitled1/src/User/index.js"],"names":["User","users","problems","Problem","API","resolve","x","Promise","func","setTimeout","reject","error","userService","login","password","response","get","params","console","log","data","user","logout","register","post","editProblem","problem","username","token","Buffer","from","toString","name","task","solution","author","id","headers","addProblem","init","problems_list_back","problems_list","Map","forEach","set","title","statement"],"mappings":"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","sourcesContent":["import User from './user'\nimport {users, problems} from \"../globals\";\nimport Problem from \"../problem/Problem\";\nimport API from '../Api/index'\n\nfunction resolve(x) {\n    return new Promise(func => {\n        setTimeout(() => {\n            func(x);\n        }, 1);\n    });\n}\n\nfunction reject(error) {\n    return new Promise((resolve, func) => {\n        setTimeout(() => {\n            func(error);\n        }, 1);\n    });\n}\n\nconst userService = {\n    async login(login, password) {\n        let response = await API.get('/login', {params: {'username': login, 'password': password}})\n        console.log(response.data)\n        if (response.data === 1) {\n            return reject('Нет таких зарегистрированных пользователей');\n        } else {\n            if (response.data === 2) {\n                return reject('Неверный пароль');\n            } else {\n                return resolve({user: new User(login, password, true)});\n            }\n        }\n    },\n\n    async logout(login) {\n        return resolve({user: null});\n    },\n\n    async register(login, password) {\n        console.log(login)\n        console.log(password)\n        const response = await API.post('/signup', {'username': login, 'password': password})\n        console.log(response)\n        if (response.data === false) {\n            return reject('Такой пользователь уже существует')\n        } else {\n            return resolve({user: new User(login, password, true)});\n        }\n    },\n\n    async editProblem(problem, user) {\n        const username = user.login\n        const password = user.password\n        const token = Buffer.from(`${username}:${password}`, 'utf8').toString('base64')\n        const data = {\n            'title': problem.name,\n            'statement': problem.task,\n            'solution': problem.solution,\n            'author': problem.author,\n            'username': user.login,\n            'id': problem.id\n        }\n        await API.post('/problem', data, {headers: {'Authorization': `Basic ${token}`}})\n        return resolve({problem: problems.get(problem.id)})\n    },\n\n    async addProblem(problem, user) {\n        const username = user.login\n        const password = user.password\n        const token = Buffer.from(`${username}:${password}`, 'utf8').toString('base64')\n        const data = {\n            'title': problem.name,\n            'statement': problem.task,\n            'solution': problem.solution,\n            'author': problem.author,\n            'username': user.login\n        }\n        await API.post('/problem', data, {headers: {'Authorization': `Basic ${token}`}})\n        return resolve({problem: problems.get(problem.id)})\n    },\n\n    async init() {\n        let problems_list_back = await API.get('/problem/all')\n        console.log('I am here')\n        console.log(problems_list_back.data)\n        let problems_list = new Map()\n        problems_list_back.data.forEach(function (problem) {\n            problems_list.set(problem.id,\n                new Problem(problem.title, problem.statement, problem.solution, problem.author, problem.username, problem.id)\n            )\n        })\n        return resolve(problems_list)\n    }\n\n}\n\nexport default userService"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import User from './user';\nimport { users, problems } from \"../globals\";\nimport Problem from \"../problem/Problem\";\nimport API from '../Api/index';\n\nfunction resolve(x) {\n  return new Promise(func => {\n    setTimeout(() => {\n      func(x);\n    }, 1);\n  });\n}\n\nfunction reject(error) {\n  return new Promise((resolve, func) => {\n    setTimeout(() => {\n      func(error);\n    }, 1);\n  });\n}\n\nconst userService = {\n  async login(login, password) {\n    // const user = await API.get()\n    if (!users.has(login)) {\n      return reject('Нет таких зарегистрированных пользователей');\n    } else {\n      if (users.get(login).password !== password) {\n        return reject('Неверный пароль');\n      } else {\n        users.get(login).isLogged = true;\n        return resolve({\n          user: users.get(login)\n        });\n      }\n    }\n  },\n\n  async logout(login) {\n    users.get(login).isLogged = false;\n    return resolve({\n      user: null\n    });\n  },\n\n  async register(login, password) {\n    console.log(login);\n    console.log(password);\n    const response = await API.post('/signup', {\n      'username': login,\n      'password': password\n    });\n    console.log(response);\n\n    if (response.data === false) {\n      return reject('Такой пользователь уже существует');\n    } else {\n      users.set(login, new User(login, password, true));\n      return resolve({\n        user: users.get(login)\n      });\n    }\n  },\n\n  async editProblem(problem) {\n    problems.get(problem.id).name = problem.name;\n    problems.get(problem.id).task = problem.task;\n    problems.get(problem.id).solution = problem.solution;\n    problems.get(problem.id).author = problem.author;\n    return resolve({\n      problem: problems.get(problem.id)\n    });\n  },\n\n  async addProblem(problem, user) {\n    problem.id = problems.size;\n    problems.set(problem.id, new Problem(problem.name, problem.task, problem.solution, problem.author, problem.user, problem.id));\n    await API.post('/problem', {\n      'id': 0,\n      'title': problem.name,\n      'statement': problem.task,\n      'solution': problem.solution\n    });\n    return resolve({\n      problem: problems.get(problem.id)\n    });\n  },\n\n  async init() {\n    return resolve(problems);\n  }\n\n};\nexport default userService;","map":{"version":3,"sources":["/home/daniil/WebstormProjects/untitled1/src/User/index.js"],"names":["User","users","problems","Problem","API","resolve","x","Promise","func","setTimeout","reject","error","userService","login","password","has","get","isLogged","user","logout","register","console","log","response","post","data","set","editProblem","problem","id","name","task","solution","author","addProblem","size","init"],"mappings":"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","sourcesContent":["import User from './user'\nimport {users, problems} from \"../globals\";\nimport Problem from \"../problem/Problem\";\nimport API from '../Api/index'\n\nfunction resolve(x) {\n    return new Promise(func => {\n        setTimeout(() => {\n            func(x);\n        }, 1);\n    });\n}\n\nfunction reject(error) {\n    return new Promise((resolve, func) => {\n        setTimeout(() => {\n            func(error);\n        }, 1);\n    });\n}\n\nconst userService = {\n    async login(login, password) {\n        // const user = await API.get()\n        if (!users.has(login)) {\n            return reject('Нет таких зарегистрированных пользователей');\n        } else {\n            if (users.get(login).password !== password) {\n                return reject('Неверный пароль');\n            } else {\n                users.get(login).isLogged = true;\n                return resolve({user: users.get(login)});\n            }\n        }\n    },\n\n    async logout(login) {\n        users.get(login).isLogged = false;\n        return resolve({user: null});\n    },\n\n    async register(login, password) {\n        console.log(login)\n        console.log(password)\n        const response = await API.post('/signup', {'username': login, 'password': password})\n        console.log(response)\n        if (response.data === false) {\n            return reject('Такой пользователь уже существует')\n        } else {\n            users.set(login, new User(login, password, true))\n            return resolve({user: users.get(login)});\n        }\n    },\n\n    async editProblem(problem) {\n        problems.get(problem.id).name = problem.name;\n        problems.get(problem.id).task = problem.task;\n        problems.get(problem.id).solution = problem.solution;\n        problems.get(problem.id).author = problem.author;\n        return resolve({problem: problems.get(problem.id)})\n    },\n\n    async addProblem(problem, user) {\n        problem.id = problems.size\n        problems.set(problem.id, new Problem(problem.name, problem.task, problem.solution, problem.author, problem.user, problem.id))\n        \n        await API.post('/problem', {'id': 0, 'title': problem.name, 'statement': problem.task, 'solution': problem.solution})\n        return resolve({problem: problems.get(problem.id)})\n    },\n\n    async init() {\n        return resolve(problems)\n    }\n\n}\n\nexport default userService"]},"metadata":{},"sourceType":"module"}